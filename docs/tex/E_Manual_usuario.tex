\apendice{Documentación de usuario}

\section{Introducción}

Este manual detalla todos los pasos necesarios para poder instalar en cualquier plataforma la aplicación. Se definirán los requisitos previos que tiene que tener los usuarios así como un manual de uso de la propia página web.

\section{Requisitos de usuarios}

La aplicación utiliza la tecnología de docker para funcionar, con todas sus ventajas y un pequeño inconveniente:

\begin{itemize}
	\item \textbf{Necesitas tener docker instalado en el equipo en el que vayas a desplegar la aplicación.}
\end{itemize}

Los requisitos indispensables para poder utilizar la aplicación son los siguientes:

\begin{enumerate}
	\item Instalar la plataforma de docker \cite{web:dockerDesktop} y docker compose \cite{web:dockercompose}.
	\begin{itemize}
		\item Windows: Docker Desktop.
		\item Linux: Instalar Docker y Docker Compose, ya sea con Docker Desktop o desde el repositorio de la versión de linux correspondiente.
		\item Mac: Docker Desktop.
	\end{itemize}
	\item Disponer de un navegador web.
	\item Disponer de un programa para descomprimir ficheros \textit{.zip} o \textit{.tar.gz}.
\end{enumerate}

\section{Instalación}

\subsection{Descarga del código}

La descarga del código se realiza desde esta página: \url{https://github.com/Daniel-Fernandez-UBU/riskRealUBU/releases}

\imagen{instalacionReleases}{Página de selección de release}

Lo recomendable es siempre utilizar la última versión, ya que tendrá el mayor número de funcionalidades y el menor número de errores.

De la imagen anterior se puede ver que tenemos la posibilidad de descargar tres posibles ficheros:

\begin{itemize}
	\item Source code: Comprimido en dos formatos distintintos: Contiene el código completo del proyecto.
	\item Install.zip: Contiene la carpeta de instalación, la única que vamos a necesitar para poner a funcionar nuestra aplicación.
\end{itemize}

\textit{Nota: Si has descargado Source code, tras descomprimirlo y acceder a la carpeta del proyecto, tendrás una carpeta install, que es donde está la parte que importa para la instalación de la aplicación.}

\subsection{Contenido de la carpeta install}

La estructura de la carpeta es la siguiente:

\imagen{installTree}{Contenido y estructura de la carpeta install.}

\subsubsection{Fichero docker-compose.yml}

Este es único fichero realmente necesario, ya que con el simple comando \textbf{docker compose up} en el mismo directorio en el que se encuentra este fichero, se levanta la aplicación.

La explicación del contenido se ha realizado en \ref{subsec:dockerComposeFile}.

\subsection{Instalación de la aplicación}

Desde la línea de comandos, navegamos hasta acceder a la carpeta install y estar al mismo nivel que \textit{docker-compose.yml, dbdata y appFiles}.

\subsubsection{Instalación supervisada}

Escribimos \textbf{docker compose up} y empezamos a ver cómo se lanzan las aplicaciones paso a paso. Si es la primera vez, tiene que hacer una descarga de las imágenes al repositorio de imágenes de docker, por lo que es normal que lleve algo más de tiempo.
\imagen{dockerComposeUP}{Comando para la instalación.}

En la siguiente imagen se ve el resultado de una ejecución correcta:
\imagen{dockerComposeRunning}{Aplicación funcionando.}

Desde otra consola de símbolo del sistema o desde Docker Desktop, podemos ver nuestros docker funcionando:
\imagen{dockerWorking}{Dockers en ejecución.}

Para parar la ejecución y eliminar los docker, pulsamos \textit{Ctrl + C} y escribimos \textit{docker compose down} en la ventana del símbolo del sistema en la que los teníamos en ejecución.
\imagen{dockerStop}{Parada de los docker lanzados.}

\subsubsection{Instalación desatendida}

El proceso es el mismo que en el paso anterior, con la diferencia de que esta vez no vamos a ver cómo se van lanzando los contenedores, pero con la ventaja de que vamos a poder cerrar la ventana del símbolo del sistema y van a seguir en ejecución.

Escribimos \textbf{docker compose up -d} y comprobamos con \textit{docker ps} cuando se han levantado nuestros dockers:
\imagen{dockerComposeUPD}{Comando para la instalación desatendida.}

Si queremos parar la aplicación podemos lanzar el comando \textit{docker compose down} explicado en la sección anterior, pero tenemos que lanzarlo estando a la altura de nuestro fichero \textit{docker-compose.yml} para que funcione.

\section{Manual del usuario}

Este manual va a servir como guía para poder navegar por la aplicación de forma sencilla.
Nota: \textit{Las imágenes de los cuestionarios que se muestran en este manual son imágenes de prueba que se han precargado en cuestionarios de prueba, aunque siempre aparezca la misma.}

En primer lugar accedemos a la aplicación, actualmente la url por defecto de acceso es \url{localhost:8088}.

\imagen{appInicio}{Pantalla de inicio de la aplicación web.}

En la barra superior tenemos varias opciones disponibles, la de cambio de idioma:

\imagen{appIdioma}{Selección de idioma de la aplicación web.}

Y la de Inicio de Sesión o Registro:

\imagen{appInvitado}{Opciones de usuario de la aplicación web.}

También se puede realizar el cuestionario disponible para usuarios anónimos, pulsando en el botón que tenemos en el centro de la imagen del cuestionario.

Si seleccionas Registro, te saldrá un formulario con diversos campos que tienes que completar, algunos de ellos solo permiten valores de un listado:

\imagen{appRegistro}{Registro en la aplicación web.}

Una vez te registres, te envía a la página de inicio de sesión para que introduzcas tus datos y accedas a la aplicación.

Si en la página inicial hubieses seleccionado iniciar sesión:

\imagen{appInicioSesion}{Pantalla de inicio de sesión de la aplicación web.}

Te encontrarás con un formulario para incluir tu nombre de usuario (correo electrónico) y y tu contraseña. 

Tras hacerlo te devuelve a la página inicial, desde la que podrás iniciar un cuestionario, cambiar el idioma, cerrar sesión o ver tu perfíl.

Al ser un usuario autenticado, te saldrán estas dos últimas opciones que te comentaba al pulsar en tu nombre, en la barra de navegación de la aplicación:

\imagen{appUserEng}{Pantalla de inicio de la aplicación web en inglés.}

Se ha cambiado el idioma a inglés solo para mostrar la funcionalidad.

Si accedes a tu perfíl, podrás ver todos los datos que acabas de incluir, editar los que consideres e incluso cambiar tu contraseña:

\imagen{appPerfil}{Pantalla de perfíl de usuario.}

Si decides iniciar uno de los cuestionarios disponibles desde la página de inicio, te saldrá una pantalla similar a esta:

\imagen{appDesCuestionario}{Pantalla de descripción del cuestionario.}


Donde verás la imágen princiapl del cuestionario junto con una descripción del mismo. Finalmente podrás darle a iniciar cuando consideres.

Tras iniciar el cuestionario, tendrá un formato similar al de esta imagen:

\imagen{appIniCuest}{Pantalla de inicio de la aplicación web.}

Con las opciones a la izquierda, la imagen relacionada con la pregunta a la derecha y debajo 3 botones: Anterior, Siguiente o Enviar resultados.

Los botones, según avances, en las preguntas, se irán habilitando, para que puedas retroceder sin problema en cualquier momento, lo único indispensables es que si quieres cambiar de pregunta debes seleccionar alguna respuesta antes de poder hacerlo. Lo mismo sucede al enviar resultados, por lo que todas las preguntas deben haber sido seleccionadas.

Al llegar a la última pregunta y pulsar en ``Enviar Resultados'', te saldrá una nueva pantalla, con el resultado que has obtenido en el test:

\imagen{appResultado}{Pantalla de resultado del cuestionario.}

Si has quieres hacer el cuestionario siendo un invitado, la única diferencia es que tras pulsar en el cuestionario disponible en la página de inicio, antes del proceso anterior, te sale una pantalla donde se te piden algunos datos adicionales:

\imagen{appDataGuest}{Pantalla de datos adicionales para los usuarios anónimos.}

Por último, si has iniciado sesión con un usuario administrador, tendrás acceso a más opciones de las permitidas hasta ahora:

\imagen{appAdmin}{Opciones del usuario administrador.}

Vamos a comentar cada una de ellas:

Al seleccionar en la opción de ``Cargar Cuestionario'' accedemos a la siguiente pantalla, desde la que podemos o bien cargar un nuevo json desde el disco duro de nuestro equipo:

\imagen{appCargarJSON}{Pantalla de carga de archivos json.}

O bien generar un cuestionario utilizando un json previamente cargado:

\imagen{appGenerarCuestionario}{Pantalla de generación de cuestionarios.}

La opción de ``Descargar resultados'' la tenemos disponible desde cualquier parte de la web, excepto mientras se está realizando un cuestionario, y tras pulsar en ella, se nos descarga de forma automática un archivo \textit{score.csv} con los datos de todos los cuestionarios que se han realizado.

\imagen{appDescargaResultados}{Pantalla tras pulsar en descargar resultados.}

El usuario administrador, desde la opción de Gestión de Roles, puede modificar los permisos sobre la aplicación de otros usuarios, y convertirlos también en administrador:

\imagen{appRoles}{Pantalla de gestión de roles de la aplicación web.}

El rol del usuario administrador no es modificable en ningún caso.

Si al intentar iniciar sesión, te equivocas en la contraseña, te saldrá una nueva ventana donde puedes probar de nuevo o restarurarla:
\imagen{appLoginError}{Pantalla inicio de sesión erróneo.}


Si pulsas en \textit{Recuperar contraseña} se abre una nueva ventana donde se te pide el el correo electrónico.
\imagen{appPassRecovery}{Pantalla inicio de recuperación de contraseña.}

Si el correo introducido es correcto y el usuario está registrado en la base de datos de la aplicación, pasados unos segundos le llegará un correo a su buzón y la aplicación te devolverá a la página de inicio.

El correo de recuperación que se recibe es similar a este:
\imagen{appEmailReceived}{Correo con la nueva contraseña de un solo uso.}

Tras iniciar sesión con la contraseña que has recibido, te pedirá que la cambies:
\imagen{appCambioPass}{Pantalla cambio de contraseña.}

Después de cambiarla, volverás a la página de inicio con la sesión iniciada.

\clearpage
Por último, si deseas salir de aplicación, al pulsar en ``Cerrar Sesión'' te pedirá confirmación antes de hacerse efectivo:

\imagen{appCerrarSesion}{Pantalla de cierre de sesión.}





